# HG changeset patch
# User Ricky Stewart <rstewart@mozilla.com>
# Date 1579718174 0
# Node ID ec0a1400e4483383a2c0167f00ffa5a7eaca6133
# Parent  0ad0e4de327816dad6bbf0f1d216fc9f94ae9ce0
Bug 1610774 - put mozfile at the beginning of the user's path if necessary in configure r=firefox-build-system-reviewers,mshal

Differential Revision: https://phabricator.services.mozilla.com/D60705

diff --git a/build/moz.configure/init.configure b/build/moz.configure/init.configure
--- a/build/moz.configure/init.configure
+++ b/build/moz.configure/init.configure
@@ -254,16 +254,18 @@ def virtualenv_python2(env_python, build
             topsrcdir, topobjdir,
             os.path.join(virtualenvs_root, 'init'), out,
             os.path.join(topsrcdir, 'build', 'virtualenv_packages.txt'))
 
     # If we're not in the virtualenv, we need to update the path to include some
     # necessary modules for find_program.
     if normsep(sys.executable) != normsep(manager.python_path):
         sys.path.insert(
+            0, os.path.join(topsrcdir, 'testing', 'mozbase', 'mozfile'))
+        sys.path.insert(
             0, os.path.join(topsrcdir, 'third_party', 'python', 'backports'))
 
     if python:
         found_python = find_program(python)
         if not found_python:
             die('The PYTHON environment variable does not contain '
                 'a valid path. Cannot find %s', python)
         python = found_python
